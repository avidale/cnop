
\documentclass[letterpaper,fleqn,12pt]{article}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{geometry}
\usepackage[singlespacing]{setspace}
\usepackage{amsfonts}
\usepackage{inputenc}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{accents}
\usepackage{eurosym}
\usepackage{amssymb}
\usepackage{rotating}
\usepackage{sectsty}
\usepackage{endnotes}
\usepackage{chbibref}
\usepackage{float}
\usepackage{nopageno}
\usepackage[labelsep=period]{caption}
\usepackage{scalefnt}
\usepackage{ragged2e}

\setcounter{MaxMatrixCols}{10}
%TCIDATA{OutputFilter=LATEX.DLL}
%TCIDATA{Version=5.50.0.2960}
%TCIDATA{<META NAME="SaveForMode" CONTENT="2">}
%TCIDATA{BibliographyScheme=Manual}
%TCIDATA{Created=Wednesday, April 07, 2010 09:52:31}
%TCIDATA{LastRevised=Tuesday, May 15, 2018 14:57:33}
%TCIDATA{<META NAME="GraphicsSave" CONTENT="32">}
%TCIDATA{<META NAME="DocumentShell" CONTENT="Standard LaTeX\Blank - Standard LaTeX Article">}
%TCIDATA{Language=American English}
%TCIDATA{CSTFile=40 LaTeX article.cst}

\newtheorem{theorem}{Theorem}
\newtheorem{acknowledgement}[theorem]{Acknowledgement}
\newtheorem{algorithm}[theorem]{Algorithm}
\newtheorem{axiom}[theorem]{Axiom}
\newtheorem{case}[theorem]{Case}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{conclusion}[theorem]{Conclusion}
\newtheorem{condition}[theorem]{Condition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{criterion}[theorem]{Criterion}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{exercise}[theorem]{Exercise}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{notation}[theorem]{Notation}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{solution}[theorem]{Solution}
\newtheorem{summary}[theorem]{Summary}
\newenvironment{proof}[1][Proof]{\noindent\textbf{#1.} }{\ \rule{0.5em}{0.5em}}
\geometry{left=1 in,right=1 in,top=0.8 in,bottom=0.8 in}
\input{tcilatex}
\setlength{\abovecaptionskip}{4pt}
\makeatletter
\def\@biblabel#1{\hspace*{-\labelsep}}
\newdimen\@bibhang \@bibhang=2em
\def\setbibhang#1{\@bibhang=#1}
\renewenvironment{thebibliography}[1]{  \setlength{\labelwidth}{0pt}
  \setlength{\labelsep}{0pt}
  \section*{\refname
     \@mkboth{\uppercase{\refname}}{\uppercase{\refname}}}   \vspace{0em}
   \setlength{\parindent}{0pt}
   \def\newblock{}
   \renewcommand{\bibitem}[2][]{     \if@filesw
       {\let\protect\noexpand\immediate
        \write\@auxout{\string\bibcite{##2}{##1}}}
        \fi\hangindent=\@bibhang\hangafter=1}}
\makeatother

\begin{document}

\title{Estimation of nested and zero-inflated ordered probit models\\
\bigskip }
\date{}
\author{David Dale \\
%EndAName
Yandex\\
Moscow, Russia\\
dale.david@yandex.ru \and Andrei Sirchenko \\
%EndAName
Higher School of Economics\\
Moscow, Russia\\
andrei.sirchenko@gmail.com}
\maketitle

\begin{abstract}
We introduce three new STATA commands, \texttt{nop}, \texttt{ziop2} and 
\texttt{ziop3}, for the estimation of a three-part nested ordered probit
model, the two-part zero-inflated ordered probit models of Harris and Zhao
(2007, \textit{Journal of Econometrics }141: 1073--1099) and Brooks, Harris
and Spencer (2012,\ \textit{Economics Letters} 117: 683--686), and a
three-part zero-inflated ordered probit model for ordinal outcomes, with
both exogenous and endogenous switching. The three-part models allow the
probabilities of positive, neutral (zero) and negative outcomes to be
generated by distinct processes. The zero-inflated models address the
preponderance of zeros and allow them to emerge in different latent regimes.
We provide the postestimation commands to compute probabilistic predictions
and various measures of their accuracy, to access the goodness of fit, and
to perform model comparison using the Vuong (1989, \textit{Econometrica} 57:
307--333) test with the corrections based on the Akaike and Schwarz
information criteria. We investigate the finite-sample performance of the
maximum likelihood estimators by Monte Carlo simulations, discuss the
relations among the models, and illustrate the new commands with an
empirical application to the U.S. federal funds rate target.

\bigskip \bigskip \bigskip \bigskip \bigskip \bigskip \bigskip

\bigskip \bigskip \bigskip \bigskip

\bigskip \bigskip \bigskip \bigskip \bigskip \bigskip \bigskip

\textbf{Keywords:} ordinal outcomes, zero inflation, nested ordered probit,
zero-inflated ordered probit, endogenous switching, classification table,
Brier score, ranked probability score, precision, hit rate, adjusted
noise-to-signal ratio, Vuong test, AIC, BIC, nop, ziop2, ziop3, federal
funds rate target.

\bigskip \bigskip \bigskip \bigskip \bigskip
\end{abstract}

\section{Introduction}

We introduce the STATA\ commands, \texttt{nop}, \texttt{ziop2} and \texttt{%
ziop3}, which estimate the two-level nested and zero-inflated ordered probit
(OP) models for ordinal outcomes, including the zero- and middle-inflated OP
models of Harris and Zhao (2007), Bagozzi and Mukherjee (2012), Brooks,
Harris and Spencer (2012) and Sirchenko (2013). The rationale behind the
two-level nested decision process is standard in the discrete-choice
modeling when the set of alternatives faced by a decision-maker can be
partitioned into subsets (or nests) with similar alternatives correlated due
to the common unobserved factors. A choice among the nests and a choice
among the alternatives within each nest can be driven by the different sets
of observed and unobserved factors (and common factors can have different
weights).

In the case of unordered categorical data, in which choices can be grouped
into the nests of similar options, the nested logit model is a popular
method. The nested models for ordinal data are rare although the rationale
behind them is similar: choosing among a negative response (decrease), a
neutral response (no change) or a positive response (increase) is quite
different from choosing the magnitude of the negative or positive response;
and choosing the magnitude of the negative response can be driven by quite
different determinants than choosing the magnitude of the positive response.
This leads to the three implicit decisions: an upper-level regime decision
--- a choice among the nests, and the two lower-level outcome decisions ---
the choices of the magnitude of the negative and positive responses (see the
top left panel of Figure \ref{trees}).

\medskip \medskip

%TCIMACRO{%
%\TeXButton{B}{\begin{figure}[H]\captionsetup{singlelinecheck = false, justification=justified}}}%
%BeginExpansion
\begin{figure}[H]\captionsetup{singlelinecheck = false, justification=justified}%
%EndExpansion
\caption{Decision trees of nested and zero-inflated ordered probit
models\label{trees}}%
%TCIMACRO{\TeXButton{center}{\centering}}%
%BeginExpansion
\centering%
%EndExpansion

\begin{center}
%TCIMACRO{%
%\FRAME{itbpF}{6.44in}{2.968in}{0in}{}{}{Figure}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "T";width 6.44in;height 2.968in;depth 0in;original-width 9.1598in;original-height 4.2001in;cropleft "0";croptop "1";cropright "1";cropbottom "0";tempfilename 'P8RJ9Z02.wmf';tempfile-properties "XPR";}}}%
%BeginExpansion
\includegraphics[
natheight=4.2001in, natwidth=9.1598in, height=2.968in, width=6.44in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/P8RJ9Z02__1.pdf}%
%EndExpansion
\end{center}

%TCIMACRO{\TeXButton{TeX field}{\justify}}%
%BeginExpansion
\justify%
%EndExpansion
%TCIMACRO{%
%\TeXButton{Notes}{\footnotesize{Notes: Decisionmakers are not assumed to choose sequentially. The tree diagrams simply represent a nesting structure of the system of OP models.}}}%
%BeginExpansion
\footnotesize{Notes: Decisionmakers are not assumed to choose sequentially. The tree diagrams simply represent a nesting structure of the system of OP models.}%
%EndExpansion
%TCIMACRO{\TeXButton{E}{\end{figure}}}%
%BeginExpansion
\end{figure}%
%EndExpansion

\medskip

Furthermore, it would be reasonable for the zero (no-change) alternative to
be in three nests: its own one, one with the negative responses and one with
the positive responses; so some zeros can be driven by similar factors as
negative or positive responses. This leads to a three-part cross-nested
model with the nests overlapping at a zero response; hence, the probability
of zeros is \textquotedblleft inflated\textquotedblright . Since the regime
decision is not observable, the zeros are observationally equivalent --- it
is never known to which of the three nests the observed zero belongs. While
several types of models with overlapping nests for unordered categorical
responses are developed (Vovsha 1997; Wen and Koppelman 2001), the
cross-nested models for ordinal\ outcomes are very scarce (Small 1987).

The prevalence of status quo, neutral or zero outcomes is observed in many
fields, including economics, sociology, technometrics, psychology and
biology. The heterogeneity of zeros is widely recognized --- see Winkelmann
(2008) and Greene and Hensher (2010) for a review. Studies identify
different types of zeros such as: no visits to a doctor due to good health,
iatrophobia, or medical costs; no illness due to strong immunity or lack of
infection; no children due to infertility or choice. In the studies of
survey responses using an odd-point Likert-type scale, where the respondents
must indicate the negative, neutral or positive attitude or opinion, the
heterogeneity of indifferent responses (a true neutral option versus an
undecided, or ambivalent, or uninformed one, commonly reported as neutral)
is also well-recognized and sometimes labeled as the middle category
endorsement or inflation (Bagozzi and Mukhetjee 2012; Hern\'{a}ndez, Drasgow
and Gonz\'{a}les-Rom\'{a} 2004; Kulas and Stachowski 2009).

The two-part zero-inflated models, developed to address the unobserved
heterogeneity of zeros, combines a binary choice model for the probability
of crossing the hurdle (to participate or not to participate; to consume or
not to consume) with a count or ordered-choice model for nonnegative
outcomes above the hurdle: the two parts are estimated jointly, and the zero
observations can emerge in both parts. The two-part zero-inflated models
include the zero-inflated Poisson (Lambert 1992), negative binomial (Greene
1994), binomial (Hall 2002) and generalized Poisson (Famoye and Singh 2003)
models for count outcomes, and the zero-inflated OP model (Harris and Zhao
2007) and zero-inflated proportional odds model (Kelley and Anderson 2008)
for non-negative ordinal responses.\footnote{%
The zero-inflated models, estimation of which is currently implemented in
STATA, include: the zero-inflated Poisson model (the zip command), the
negative binomial model (the zinb command), and the binomial model (the zib
command) and the beta-binomial model (the zibbin command) developed by
Hardin and Hilbe (2014).}

The model of Harris and Zhao (2007) is suitable for explaining decisions
such as the levels of consumption, when the upper hurdle is naturally binary
(to consume or not to consume), the responses are non-negative and the
inflated\ zeros are situated at one end of the ordered scale (see the bottom
left panel of Figure \ref{trees}). Bagozzi and Mukherjee (2012) and Brooks,
Harris and Spencer (2012) modified the model of Harris and Zhao (2007) and
developed the middle-inflated OP model for an ordinal outcome, which ranges
from negative to positive responses, and where an abundant outcome is
situated in the middle of the choice spectrum (see the bottom right panel of
Figure \ref{trees}).

The three-part zero-inflated OP model (see the top right panel of Figure \ref%
{trees}) introduced in Sirchenko (2013) is a natural generalization of the
models of Harris and Zhao (2007), Bagozzi and Mukherjee (2012) and Brooks,
Harris and Spencer (2012). A trichotomous regime decision is more realistic
and flexible than a binary decision (change or no change) if applied to
ordinal data with negative, zero and positive values.

\section{\noindent Models}

\subsection{Notation and assumptions}

The observed dependent variable $y_{t}$, $t=1,2,...,T$ is assumed to take on
a finite number of ordinal values $j$ coded as $%
\{-J^{-},...,-1,0,1,...,J^{+}\},$ where a potentially heterogeneous (and
typically predominant) response is coded as zero. The latent unobserved (or
only partially observed) variables are denoted by \textquotedblleft $\ast $%
\textquotedblright . Each model assumes an ordered-choice regime decision
and the ordered-choice outcome decisions conditional on the regime. The
regime decision is allowed to be correlated with each outcome decision. We
denote: by $\mathbf{x}_{t},$ $\mathbf{x}_{t}^{-},$ $\mathbf{x}_{t}^{+}$ and $%
\mathbf{z}_{t}$ the $t^{\text{th}}$ rows of the observed data matrices
(which in addition to the predetermined explanatory variables may also
include the lags of $y_{t}$); by $\mathbf{\beta ,}$ $\mathbf{\beta }^{-},$ $%
\mathbf{\beta }^{+}$ and $\mathbf{\gamma }$ the vectors of slope parameters;
by $\mathbf{\alpha ,}$ $\mathbf{\alpha }^{-}\mathbf{,}$ $\mathbf{\alpha }%
^{+} $ and $\mathbf{\mu }$ the vectors of threshold parameters; by $\rho ,$ $%
\rho ^{-}$ and $\rho ^{+}$ the vectors of correlation coefficients; by $%
\varepsilon _{t},$ $\varepsilon _{t}^{-},$ $\varepsilon _{t}^{+}$ and $\nu
_{t}\ $the error terms that are independently and identically distributed (%
\textit{iid}) across $t$ with normal cumulative distribution function (CDF) $%
\Phi $, the zero means and the variances $\sigma ^{2},$ $\sigma _{-}^{2},$ $%
\sigma _{+}^{2}$ and $\sigma _{\nu }^{2}$, respectively; and by $\Phi
_{2}(g_{1}\mathbf{;}g_{2}\mathbf{;}\sigma _{1}^{2};\sigma _{2}^{2};\rho )$
the CDF of the bivariate normal distribution of the two random variables $%
g_{1}$ and\textbf{\ }$g_{2}$ with the zero means, the variances $\sigma
_{1}^{2}$ and $\sigma _{2}^{2}$ and the correlation coefficient $\rho $:

\begin{center}
$\Phi _{2}(g_{1}\mathbf{;}g_{2}\mathbf{;}\sigma _{1}^{2};\sigma
_{2}^{2};\rho )=\frac{1}{2\pi \sigma _{1}\sigma _{2}\sqrt{1-\rho ^{2}}}%
\underset{}{\underset{-\infty }{\overset{g_{1}}{\int }}}\underset{-\infty }{%
\overset{g_{2}}{\int }}\exp \left( -\frac{u^{2}/\sigma _{1}^{2}-2\rho
uw/\sigma _{1}\sigma _{2}+w^{2}/\sigma _{2}^{2}}{2(1-\rho ^{2})}\right)
dudw. $
\end{center}

\subsection{Three-part nested ordered probit (NOP) model}

Despite a wide-spread use of the nested logit models for unordered
categorical responses, we are aware of only one example of the nested
ordered probit model in the literature (Sirchenko 2013). The two-level NOP
model can be described as

\bigskip

$%
\begin{tabular}{ll}
\ Upper-level decision: & $r_{t}^{\ast }=\mathbf{z}_{t}\mathbf{\gamma }+\nu
_{t},$ \ \ $s_{t}=\left\{ 
\begin{array}{rcl}
1 & \text{if} & \mu _{2}<r_{t}^{\ast }, \\ 
0 & \text{if} & \mu _{1}<r_{t}^{\ast }\leq \mu _{2}, \\ 
-1 & \text{if} & \text{ \ \ \ \ \ \ }r_{t}^{\ast }\leq \mu _{1}.%
\end{array}%
\right. $ \\ 
&  \\ 
\ Lower-level decisions: & $y_{t}^{-\ast }=\mathbf{x}_{t}^{-}\mathbf{\beta }%
^{-}+\varepsilon _{t}^{-},$ \ \ $y_{t}^{+\ast }=\mathbf{x}_{t}^{+}\mathbf{%
\beta }^{+}+\varepsilon _{t}^{+},$ \\ 
& $y_{t}=\left\{ 
\begin{array}{lcl}
j(j>0) & \text{if} & s_{t}=1\text{ and }\alpha _{j-1}^{+}<y_{t}^{+\ast }\leq
\alpha _{j}^{+}, \\ 
0 & \text{if} & s_{t}=0, \\ 
j(j<0) & \text{if} & s_{t}=-1\text{ \ \ and }\alpha _{j}^{-}<y_{t}^{-\ast
}\leq \alpha _{j+1}^{-},%
\end{array}%
\right. $ \\ 
& where $-\infty =\alpha _{0}^{+}\leq \alpha _{1}^{+}\leq ...\leq \alpha
_{J^{+}}^{+}=\infty $ \\ 
& and $-\infty =\alpha _{-J^{-}}^{-}\leq \alpha _{-J^{-}+1}^{-}\leq ...\leq
\alpha _{0}^{-}=\infty $. \\ 
&  \\ 
\begin{tabular}{l}
Correlation among \\ 
decisions:%
\end{tabular}
& $\left[ 
\begin{array}{c}
\nu _{t} \\ 
\varepsilon _{t}^{i}%
\end{array}%
\right] \overset{iid}{\sim }\mathcal{N}\left( 
\begin{array}{c}
0 \\ 
0%
\end{array}%
,\left[ 
\begin{array}{cc}
\sigma _{\nu }^{2} & \rho ^{i}\sigma _{\nu }\sigma _{i} \\ 
\rho ^{i}\sigma _{\nu }\sigma _{i} & \sigma _{i}^{2}%
\end{array}%
\right] \right) $, $i\in \{-,+\}.$%
\end{tabular}%
$

\bigskip

The probabilities of the outcome $j$ in the NOP model are given by%
\begin{equation}
\begin{array}{l}
\Pr (y_{t}=j|\mathbf{z}_{t},\mathbf{x}_{t}^{-},\mathbf{x}_{t}^{+})=I_{j<0}%
\Pr (r_{t}^{\ast }\leq \mu _{1}\ \text{and }\alpha _{j}^{-}<y_{t}^{-\ast
}\leq \alpha _{j+1}^{-}|\mathbf{z}_{t},\mathbf{x}_{t}^{-}) \\ 
+I_{j=0}\Pr (\mu _{1}<r_{t}^{\ast }\leq \mu _{2}|\mathbf{z}_{t})+I_{j>0}\Pr
(\mu _{2}<r_{t}^{\ast }\ \text{and }\alpha _{j-1}^{+}<y_{t}^{+\ast }\leq
\alpha _{j}^{+}|\mathbf{z}_{t},\mathbf{x}_{t}^{+}) \\ 
=I_{j<0}\Pr (\nu _{t}\leq \mu _{1}-\mathbf{z}_{t}\mathbf{\gamma }\ \text{and 
}\alpha _{j}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta }^{-}<\varepsilon
_{t}^{-}\leq \alpha _{j+1}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta }^{-}) \\ 
+I_{j=0}\Pr (\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma }<\nu _{t}\leq \mu _{2}-%
\mathbf{z}_{t}\mathbf{\gamma }) \\ 
+I_{j>0}\Pr (\mu _{2}-\mathbf{z}_{t}\mathbf{\gamma }<\nu _{t}\ \text{and }%
\alpha _{j-1}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta }^{+}<\varepsilon
_{t}^{+}\leq \alpha _{j}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta }^{+}) \\ 
=I_{j<0}[\Phi _{2}(\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma };\alpha _{j+1}^{-}-%
\mathbf{x}_{t}^{-}\mathbf{\beta }^{-}\mathbf{;}\sigma _{\nu }^{2};\sigma
_{-}^{2};\rho ^{-})-\Phi _{2}(\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma };\alpha
_{j}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta }^{-}\mathbf{;}\sigma _{\nu
}^{2};\sigma _{-}^{2};\rho ^{-})] \\ 
+I_{j=0}[\Phi (\mu _{2}-\mathbf{z}_{t}\mathbf{\gamma ;}\sigma _{\nu
}^{2})-\Phi (\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma ;}\sigma _{\nu }^{2})] \\ 
+I_{j>0}[\Phi _{2}(-\mu _{2}+\mathbf{z}_{t}\mathbf{\gamma };\alpha _{j}^{+}-%
\mathbf{x}_{t}^{+}\mathbf{\beta }^{+};\sigma _{\nu }^{2};\sigma _{+}^{2};%
\mathbf{-}\rho ^{+}) \\ 
-\Phi _{2}(-\mu _{2}+\mathbf{z}_{t}\mathbf{\gamma };\alpha _{j-1}^{+}-%
\mathbf{x}_{t}^{+}\mathbf{\beta }^{+};\sigma _{\nu }^{2};\sigma _{+}^{2};%
\mathbf{-}\rho ^{+})]\text{,}%
\end{array}
\label{Prob NOP}
\end{equation}

\noindent where $I_{j<0}$ is an indicator function such that $I_{j<0}=1$ if $%
j<0$, and $I_{j<0}=0$ if $j\geq 0$ (analogously for $I_{j=0}$ and $I_{j>0}$).

In the case of exogenous switching (when $\rho ^{-}=\rho ^{+}=0$), the
probabilities of the outcome $j$ in the NOP can be computed as

\begin{center}
$%
\begin{array}{l}
\Pr (y_{t}=j|\mathbf{z}_{t},\mathbf{x}_{t}^{-},\mathbf{x}_{t}^{+},\rho
^{-}=\rho ^{+}=0) \\ 
=I_{j<0}\Phi (\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma ;}\sigma _{\nu }^{2}%
\mathbf{)}[\Phi (\alpha _{j+1}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta }%
^{-};\sigma _{-}^{2})-\Phi (\alpha _{j}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta }%
^{-};\sigma _{-}^{2})] \\ 
+I_{j=0}[\Phi (\mu _{2}-\mathbf{z}_{t}\mathbf{\gamma })-\Phi (\mu _{1}-%
\mathbf{z}_{t}\mathbf{\gamma })] \\ 
+I_{j>0}[1-\Phi (\mu _{2}-\mathbf{z}_{t}\mathbf{\gamma ;}\sigma _{\nu
}^{2})][\Phi (\alpha _{j}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta }^{+};\sigma
_{+}^{2})-\Phi (\alpha _{j-1}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta }%
^{+};\sigma _{+}^{2})]\text{.}%
\end{array}%
$
\end{center}

In the case of two or three outcome choices the NOP model degenerates to the
conventional single-equation OP model.

\subsection{Two-part zero-inflated ordered probit (ZIOP-2) model}

The ZIOP-2 model, which represents the zero-inflated OP model of Brooks,
Harris and Spencer (2012) and the middle-inflated OP model of Bagozzi and
Mukherjee (2012), can be described by the following system

\medskip

$%
\begin{tabular}{ll}
\ Regime decision: & $r_{t}^{\ast }=\mathbf{z}_{t}\mathbf{\gamma }+\nu _{t},$
\ \ $s_{t}^{\ast }=\left\{ 
\begin{array}{rcl}
1 & \text{if} & \mu <r_{t}^{\ast }, \\ 
0 & \text{if} & r_{t}^{\ast }\leq \mu .%
\end{array}%
\right. $ \\ 
&  \\ 
\ Outcome decision: \ \ \ \ \ \  & $y_{t}^{\ast }=\mathbf{x}_{t}\mathbf{%
\beta }+\varepsilon _{t},$ \\ 
& $y_{t}=\left\{ 
\begin{array}{lcl}
j & \text{if} & s_{t}^{\ast }=1\text{ and }\alpha _{j-1}<y_{t}^{\ast }\leq
\alpha _{j}, \\ 
0 & \text{if} & s_{t}^{\ast }=0,%
\end{array}%
\right. $ \\ 
& where $-\infty =\alpha _{-J^{-}-1}\leq \alpha _{-J^{-}}\leq ...\leq \alpha
_{J^{+}}=\infty .$ \\ 
&  \\ 
\begin{tabular}{l}
Correlation among \\ 
decisions:%
\end{tabular}
& $\left[ 
\begin{array}{c}
\nu _{t} \\ 
\varepsilon _{t}%
\end{array}%
\right] \overset{iid}{\sim }\mathcal{N}\left( 
\begin{array}{c}
0 \\ 
0%
\end{array}%
,\left[ 
\begin{array}{cc}
\sigma _{\nu }^{2} & \rho \sigma _{\nu }\sigma \\ 
\rho \sigma _{\nu }\sigma & \sigma ^{2}%
\end{array}%
\right] \right) .$%
\end{tabular}%
$

\bigskip

The probabilities of the outcome $j$ in the ZIOP-2 model are given by%
\begin{equation}
\begin{array}{l}
\Pr (y_{t}=j|\mathbf{z}_{t},\mathbf{x}_{t})=I_{j=0}\Pr (r_{t}^{\ast }\leq
\mu |\mathbf{z}_{t})+\Pr (\mu <r_{t}^{\ast }\ \text{and }\alpha
_{j-1}<y_{t}^{\ast }\leq \alpha _{j}|\mathbf{z}_{t},\mathbf{x}_{t}) \\ 
=I_{j=0}\Pr (\nu _{t}\leq \mu -\mathbf{z}_{t}\mathbf{\gamma })+\Pr (\mu -%
\mathbf{z}_{t}\mathbf{\gamma }<\nu _{t}\ \text{and }\alpha _{j-1}-\mathbf{x}%
_{t}\mathbf{\beta }<\varepsilon _{t}\leq \alpha _{j}-\mathbf{x}_{t}\mathbf{%
\beta }) \\ 
=I_{j=0}\Phi (\mu -\mathbf{z}_{t}\mathbf{\gamma ;}\sigma _{\nu }^{2})+\Phi
_{2}(-\mu +\mathbf{z}_{t}\mathbf{\gamma };\alpha _{j}-\mathbf{x}_{t}\mathbf{%
\beta };\sigma _{\nu }^{2};\sigma ^{2};\mathbf{-}\rho ) \\ 
-\Phi _{2}(-\mu +\mathbf{z}_{t}\mathbf{\gamma };\alpha _{j-1}-\mathbf{x}_{t}%
\mathbf{\beta };\sigma _{\nu }^{2};\sigma ^{2};\mathbf{-}\rho )\text{.}%
\end{array}
\label{Prob MIOP}
\end{equation}

In the case of exogenous switching (when $\rho =0$), these probabilities can
be computed as

\begin{center}
$%
\begin{array}{l}
\Pr (y_{t}=j|\mathbf{z}_{t},\mathbf{x}_{t},\rho =0)=I_{j=0}\Phi (\mu -%
\mathbf{z}_{t}\mathbf{\gamma ;}\sigma _{\nu }^{2}) \\ 
+[1-\Phi (\mu -\mathbf{z}_{t}\mathbf{\gamma ;}\sigma _{\nu }^{2})][\Phi
(\alpha _{j}-\mathbf{x}_{t}\mathbf{\beta ;}\sigma ^{2})-\Phi (\alpha _{j-1}-%
\mathbf{x}_{t}\mathbf{\beta ;}\sigma ^{2})].%
\end{array}%
$
\end{center}

If $y_{t}\geq 0$ for $\forall t,$ the ZIOP-2 model becomes the model of
Harris and Zhao (2007).

\subsection{Three-part zero-inflated ordered probit (ZIOP-3) model}

The ZIOP-3 model developed by Sirchenko (2013) is a three-part
generalization of the ZIOP-2 model, and can be described by the following
system

\medskip

\medskip $%
\begin{tabular}{ll}
\ Regime decision: & $r_{t}^{\ast }=\mathbf{z}_{t}\mathbf{\gamma }+\nu _{t},$
\ \ $s_{t}^{\ast }=\left\{ 
\begin{array}{rcl}
1 & \text{if} & \mu _{2}<r_{t}^{\ast }, \\ 
0 & \text{if} & \mu _{1}<r_{t}^{\ast }\leq \mu _{2}, \\ 
-1 & \text{if} & \text{ \ \ \ \ \ \ }r_{t}^{\ast }\leq \mu _{1}.%
\end{array}%
\right. $ \\ 
&  \\ 
\ Outcome decisions: & $y_{t}^{-\ast }=\mathbf{x}_{t}^{-}\mathbf{\beta }%
^{-}+\varepsilon _{t}^{-},$ \ \ $y_{t}^{+\ast }=\mathbf{x}_{t}^{+}\mathbf{%
\beta }^{+}+\varepsilon _{t}^{+},$ \\ 
& $y_{t}=\left\{ 
\begin{array}{lcl}
j(j\geq 0) & \text{if} & s_{t}^{\ast }=1\text{ \ \ and }\alpha
_{j-1}^{+}<y_{t}^{+\ast }\leq \alpha _{j}^{+}, \\ 
0 & \text{if} & s_{t}^{\ast }=0, \\ 
j(j\leq 0) & \text{if} & s_{t}^{\ast }=-1\text{ and }\alpha
_{j}^{-}<y_{t}^{-\ast }\leq \alpha _{j+1}^{-},%
\end{array}%
\right. $ \\ 
& where $-\infty =\alpha _{-1}^{+}\leq \alpha _{0}^{+}\leq ...\leq \alpha
_{J^{+}}^{+}=\infty $ \\ 
& and $-\infty =\alpha _{-J^{-}}^{-}\leq \alpha _{-J^{-}+1}^{-}\leq ...\leq
\alpha _{1}^{-}=\infty $. \\ 
&  \\ 
\begin{tabular}{l}
Correlation among \\ 
decisions:%
\end{tabular}
& $\left[ 
\begin{array}{c}
\nu _{t} \\ 
\varepsilon _{t}^{i}%
\end{array}%
\right] \overset{iid}{\sim }\mathcal{N}\left( 
\begin{array}{c}
0 \\ 
0%
\end{array}%
,\left[ 
\begin{array}{cc}
\sigma _{\nu }^{2} & \rho ^{i}\sigma _{\nu }\sigma _{i} \\ 
\rho ^{i}\sigma _{\nu }\sigma _{i} & \sigma _{i}^{2}%
\end{array}%
\right] \right) $, $i\in \{-,+\}.$%
\end{tabular}%
$

\bigskip

The probabilities of the outcome $j$ in the ZIOP-3 model are given by

\begin{flushleft}
\begin{equation}
\begin{array}{l}
\Pr (y_{t}=j|\mathbf{z}_{t},\mathbf{x}_{t}^{-},\mathbf{x}_{t}^{+})=I_{j\leq
0}\Pr (r_{t}^{\ast }\leq \mu _{1}\ \text{and }\alpha _{j}^{-}<y_{t}^{-\ast
}\leq \alpha _{j+1}^{-}|\mathbf{z}_{t},\mathbf{x}_{t}^{-}) \\ 
+I_{j=0}\Pr (\mu _{1}<r_{t}^{\ast }\leq \mu _{2}|\mathbf{z}_{t})+I_{j\geq
0}\Pr (\mu _{2}<r_{t}^{\ast }\ \text{and }\alpha _{j-1}^{+}<y_{t}^{+\ast
}\leq \alpha _{j}^{+}|\mathbf{z}_{t},\mathbf{x}_{t}^{+}) \\ 
=I_{j\leq 0}\Pr (\nu _{t}\leq \mu _{1}-\mathbf{z}_{t}\mathbf{\gamma }\ \text{%
and }\alpha _{j}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta }^{-}<\varepsilon
_{t}^{-}\leq \alpha _{j+1}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta }^{-}) \\ 
+I_{j=0}\Pr (\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma }<\nu _{t}\leq \mu _{2}-%
\mathbf{z}_{t}\mathbf{\gamma }) \\ 
+I_{j\geq 0}\Pr (\mu _{2}-\mathbf{z}_{t}\mathbf{\gamma }<\nu _{t}\ \text{and 
}\alpha _{j-1}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta }^{+}<\varepsilon
_{t}^{+}\leq \alpha _{j}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta }^{+}) \\ 
=I_{j\leq 0}[\Phi _{2}(\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma };\alpha
_{j+1}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta }^{-}\mathbf{;}\sigma _{\nu
}^{2};\sigma _{-}^{2};\rho ^{-})-\Phi _{2}(\mu _{1}-\mathbf{z}_{t}\mathbf{%
\gamma };\alpha _{j}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta }^{-}\mathbf{;}%
\sigma _{\nu }^{2};\sigma _{-}^{2};\rho ^{-})] \\ 
+I_{j=0}[\Phi (\mu _{2}-\mathbf{z}_{t}\mathbf{\gamma ;}\sigma _{\nu
}^{2})-\Phi (\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma ;}\sigma _{\nu }^{2})] \\ 
+I_{j\geq 0}[\Phi _{2}(-\mu _{2}+\mathbf{z}_{t}\mathbf{\gamma };\alpha
_{j}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta }^{+}\mathbf{;}\sigma _{\nu }^{2}%
\mathbf{;}\sigma _{+}^{2};\mathbf{-}\rho ^{+}) \\ 
-\Phi _{2}(-\mu _{2}+\mathbf{z}_{t}\mathbf{\gamma };\alpha _{j-1}^{+}-%
\mathbf{x}_{t}^{+}\mathbf{\beta }^{+}\mathbf{;}\sigma _{\nu }^{2}\mathbf{;}%
\sigma _{+}^{2};\mathbf{-}\rho ^{+})]\text{,}%
\end{array}
\label{Prob CroNOP}
\end{equation}
\end{flushleft}

\noindent where $I_{j\leq 0}$ is an indicator function such that $I_{j\leq
0}=1$ if $j\leq 0$, and $I_{j\leq 0}=0$ if $j>0$ (analogously for $I_{j\geq
0}$).

In the case of exogenous switching (when $\rho ^{-}=\rho ^{+}=0$), these
probabilities can be computed as

\begin{center}
$%
\begin{array}{l}
\Pr (y_{t}=j|\mathbf{z}_{t},\mathbf{x}_{t}^{-},\mathbf{x}_{t}^{+},\rho
^{-}=\rho ^{+}=0)=I_{j\leq 0}\Phi (\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma 
\mathbf{;}\sigma _{\nu }^{2})}[\Phi (\alpha _{j+1}^{-}-\mathbf{x}_{t}^{-}%
\mathbf{\beta }^{-}\mathbf{;}\sigma _{-}^{2}) \\ 
-\Phi (\alpha _{j}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta }^{-}\mathbf{;}\sigma
_{-}^{2})]+I_{j=0}[\Phi (\mu _{2}-\mathbf{z}_{t}\mathbf{\gamma ;}\sigma
_{\nu }^{2})-\Phi (\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma ;}\sigma _{\nu
}^{2})] \\ 
+I_{j\geq 0}[1-\Phi (\mu _{2}-\mathbf{z}_{t}\mathbf{\gamma ;}\sigma _{\nu
}^{2})][\Phi (\alpha _{j}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta }^{+}\mathbf{;}%
\sigma _{+}^{2})-\Phi (\alpha _{j-1}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta }%
^{+}\mathbf{;}\sigma _{+}^{2})]\text{.}%
\end{array}%
$
\end{center}

The inflated outcome does not have to be in the \emph{very} middle of the
ordered choices. If it is located at the \emph{end} of the ordered scale,
i.e. if $y_{t}\geq 0$ for $\forall t,$ the ZIOP-3 model reduces to the
ZIOP-2 model of Harris and Zhao (2007).

\subsection{Maximum likelihood (ML) estimation}

The probabilities in each OP equation can be consistently estimated under
fairly general conditions by an asymptotically normal ML estimator (Basu and
de Jong 2007). The simultaneous estimation of the OP equations in the NOP,
ZIOP-2 and ZIOP-3 models can be also performed using an ML estimator of the
vector of the parameters $\mathbf{\theta }$ that solves

\begin{equation}
\underset{\mathbf{\theta \epsilon \Theta }}{\max }\overset{}{\underset{}{%
\underset{t=1}{\overset{T}{\sum }}}}\overset{J^{+}}{\underset{j=-J^{-}}{\sum 
}}I_{tj}\ln [\Pr (y_{t}=j|\mathbf{x}_{t}^{all},\mathbf{\theta })]\text{,}
\label{LL}
\end{equation}

\noindent where $I_{tj}$ is an indicator function such that $I_{tj}=1$ if $%
y_{t}=j$ and $I_{tj}=0$ otherwise; $\mathbf{\theta }$ includes $\mathbf{%
\gamma ,}$ $\mathbf{\mu ,}$ $\mathbf{\beta }^{-},$ $\mathbf{\beta }^{+},$ $%
\mathbf{\alpha }^{-},$ $\mathbf{\alpha }^{+},$ $\rho ^{-}$ and $\rho ^{+}$
for the NOP and ZIOP-3 models, and $\mathbf{\gamma },$ $\mu ,$ $\mathbf{%
\beta },$ $\mathbf{\alpha }$ and $\rho $ for the ZIOP-2 model; $\Theta $ is
a parameters' space; $\mathbf{x}_{t}^{all}$ is a vector that contains the
values of all covariates in the model; and $\Pr (y_{t}=j|\mathbf{x}%
_{t}^{all},\mathbf{\theta })$ are the probabilities from either (\ref{Prob
NOP}) or (\ref{Prob MIOP}) or (\ref{Prob CroNOP}). The asymptotic standard
errors of $\widehat{\mathbf{\theta }}$ can be computed from the Hessian
matrix.

The intercept components of $\mathbf{\beta ,}$ $\mathbf{\beta }^{-},$ $%
\mathbf{\beta }^{+}$ and $\mathbf{\gamma }$ are identified up to scale and
location, that is only jointly with the corresponding threshold parameters $%
\mathbf{\alpha ,}$ $\mathbf{\alpha }^{-}\mathbf{,}$ $\mathbf{\alpha }^{+}$
and $\mathbf{\mu }$ and variances $\sigma ^{2},$ $\sigma _{-}^{2},$ $\sigma
_{+}^{2},$ and $\sigma _{\nu }^{2}$. As is common in the identification of
discrete-choice models, the variances $\sigma ^{2},$ $\sigma _{-}^{2},$ $%
\sigma _{+}^{2},$ and $\sigma _{\nu }^{2}$ are fixed to one, and the
intercept components of $\mathbf{\beta ,}$ $\mathbf{\beta }^{-},$ $\mathbf{%
\beta }^{+}$ and $\mathbf{\gamma }$ are fixed to zero. The probabilities in (%
\ref{Prob NOP}), (\ref{Prob MIOP}) and (\ref{Prob CroNOP}) are invariant to
these (arbitrary) identifying assumptions: up to scale and location, we can
identify all parameters in $\mathbf{\theta }$ because of the nonlinearity of
OP equations, i.e. via the functional form (Heckman 1978; Wilde 2000).
However, since the normal CDF is approximately linear in the middle of its
support, the simultaneous estimation of two or three equations may
experience a weak identification problem if the regime and outcome equations
contain the same set of covariates. To enhance the precision of parameter
estimates we may impose exclusion restrictions on the specification of
covariates in each equation.

The three regimes (nests) in the NOP model are fully observable, contrary to
the latent (only partially observed) regimes in the ZIOP-2 and ZIOP-3
models. The likelihood function of the NOP model ---\ again in contrast with
the ZIOP-2 and ZIOP-3 models --- is separable with respect to the parameters
in the three equations. Thus, solving (\ref{LL}) for the NOP model is
equivalent to maximizing separately the likelihoods of the three OP models
representing the upper- and lower-level decisions.\footnote{%
The data matrices in the lower-level decisions should be truncated to
contain only those rows of $\mathbf{x}_{t}^{-}$ or $\mathbf{x}_{t}^{+}$ for
which $y_{t}<0$ or $y_{t}>0$, respectively.}

\subsection{Marginal effects (ME)}

\noindent The marginal effect of a continuous covariate $k$ (the $k^{\text{th%
}}$ element of $\mathbf{x}_{t}^{all}$) on the probability of each discrete
outcome $j$ are computed for the ZIOP-3 model as

\bigskip

$%
\begin{array}{l}
\text{ME}_{k,j,t}=\frac{\partial \Pr (y_{t}=j|\mathbf{\theta })}{\partial 
\mathbf{x}_{t,k}^{all}}=I_{j\leq 0}\left\{ \left[ \Phi \left( \frac{\mu _{1}-%
\mathbf{z}_{t}\mathbf{\gamma }-\rho ^{-}(\alpha _{j}^{-}-\mathbf{x}_{t}^{-}%
\mathbf{\beta ^{-})}}{\sqrt{1-(\rho ^{-})^{2}}}\right) f(\alpha _{j}^{-}-%
\mathbf{x}_{t}^{-}\mathbf{\beta ^{-}})\right. \right. \\ 
\left. -\Phi \left( \frac{\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma }-\rho
^{-}(\alpha _{j+1}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta ^{-})}}{\sqrt{1-(\rho
^{-})^{2}}}\right) f(\alpha _{j+1}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta ^{-}})%
\right] \mathbf{\beta }_{k}^{-all} \\ 
\left. -\left[ \Phi \left( \frac{\alpha _{j+1}^{-}-\mathbf{x}_{t}^{-}\mathbf{%
\beta ^{-}}-\rho ^{-}(\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma )}}{\sqrt{%
1-(\rho ^{-})^{2}}}\right) -\Phi \left( \frac{\alpha _{j}^{-}-\mathbf{x}%
_{t}^{-}\mathbf{\beta ^{-}}-\rho ^{-}(\mu _{1}-\mathbf{z}_{t}\mathbf{\gamma )%
}}{\sqrt{1-(\rho ^{-})^{2}}}\right) \right] f(\mu _{1}-\mathbf{z}_{t}\mathbf{%
\gamma })\mathbf{\gamma }_{k}^{all}\right\} \\ 
-I_{j=0}[f(\mu _{2}-\mathbf{z}_{t}\mathbf{\gamma })-f(\mu _{1}-\mathbf{z}_{t}%
\mathbf{\gamma })]\mathbf{\gamma }_{k}^{all} \\ 
+I_{j\geq 0}\left\{ \left[ \Phi \left( \frac{\mathbf{z}_{t}\mathbf{\gamma }%
-\mu _{2}+\rho ^{+}(\alpha _{j-1}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta ^{+})}%
}{\sqrt{1-(\rho ^{+})^{2}}}\right) \right. \right. f(\alpha _{j-1}^{+}-%
\mathbf{x}_{t}^{+}\mathbf{\beta ^{+}}) \\ 
\left. -\Phi \left( \frac{\mathbf{z}_{t}\mathbf{\gamma }-\mu _{2}+\rho
^{+}(\alpha _{j}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta ^{+})}}{\sqrt{1-(\rho
^{+})^{2}}}\right) f(\alpha _{j}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta ^{+}})%
\right] \mathbf{\beta }_{k}^{+all} \\ 
\left. +\left[ \Phi \left( \frac{\alpha _{j}^{+}-\mathbf{x}_{t}^{+}\mathbf{%
\beta ^{+}}+\rho ^{+}(\mathbf{z}_{t}\mathbf{\gamma }-\mu _{2}\mathbf{)}}{%
\sqrt{1-(\rho ^{+})^{2}}}\right) -\Phi \left( \frac{\alpha _{j-1}^{+}-%
\mathbf{x}_{t}^{+}\mathbf{\beta ^{+}}+\rho ^{+}(\mathbf{z}_{t}\mathbf{\gamma 
}-\mu _{2}\mathbf{)}}{\sqrt{1-(\rho ^{+})^{2}}}\right) \right] f(\mathbf{z}%
_{t}\mathbf{\gamma }-\mu _{2})\mathbf{\gamma }_{k}^{all}\right\} ,%
\end{array}%
$

\bigskip

\noindent where $f$ is the probability density function of the standard
normal distribution, and $\mathbf{\gamma }_{k}^{all}$, $\mathbf{\beta }%
_{k}^{-all}$ and $\mathbf{\beta }_{k}^{+all}$ are the coefficients on the $%
k^{\text{th}}$ covariate in $\mathbf{x}_{t}^{all}$ in the regime equation,
outcome equation conditional on $s_{t}^{\ast }=1$ and outcome equation
conditional on $s_{t}^{\ast }=-1$, respectively ($\mathbf{\gamma }_{k}^{all}$%
, $\mathbf{\beta }_{k}^{-all}$ or $\mathbf{\beta }_{k}^{+all}$ is zero if
the $k^{\text{th}}$ covariate in $\mathbf{x}_{t}^{all}$ is not included into
the corresponding equation). For a discrete-valued covariate, the ME can be
computed as the change in the probabilities when this covariate changes by
one increment and all other covariates are fixed.

The MEs for the NOP model are computed by replacing $I_{j\geq 0}$ in the
above formula with $I_{j>0}$ and $I_{j\leq 0}$ with $I_{j<0}$.

The MEs for the ZIOP-2 model are computed as

\bigskip

$%
\begin{array}{l}
\text{ME}_{k,j,t}=\frac{\partial \Pr (y_{t}=j|\mathbf{\theta })}{\partial 
\mathbf{x}_{t,k}^{all}}=-I_{j=0}[f(\mu -\mathbf{z}_{t}\mathbf{\gamma })]%
\mathbf{\gamma }_{k}^{all} \\ 
+\left[ \Phi \left( \frac{\mathbf{z}_{t}\mathbf{\gamma }-\mu +\rho (\alpha
_{j-1}-\mathbf{x}_{t}\mathbf{\beta )}}{\sqrt{1-\rho ^{2}}}\right) f(\alpha
_{j-1}-\mathbf{x}_{t}\mathbf{\beta })-\Phi \left( \frac{\mathbf{z}_{t}%
\mathbf{\gamma }-\mu +\rho (\alpha _{j}-\mathbf{x}_{t}\mathbf{\beta )}}{%
\sqrt{1-\rho ^{2}}}\right) f(\alpha _{j}-\mathbf{x}_{t}\mathbf{\beta })%
\right] \mathbf{\beta }_{k}^{all} \\ 
+\left[ \Phi \left( \frac{\alpha _{j}-\mathbf{x}_{t}\mathbf{\beta }+\rho (%
\mathbf{z}_{t}\mathbf{\gamma }-\mu \mathbf{)}}{\sqrt{1-\rho ^{2}}}\right)
-\Phi \left( \frac{\alpha _{j-1}-\mathbf{x}_{t}\mathbf{\beta }+\rho (\mathbf{%
z}_{t}\mathbf{\gamma }-\mu \mathbf{)}}{\sqrt{1-\rho ^{2}}}\right) \right] f(%
\mathbf{z}_{t}\mathbf{\gamma }-\mu )\mathbf{\gamma }_{k}^{all}\text{,}%
\end{array}%
$

\bigskip

\noindent where $\mathbf{\beta }_{k}^{all}$ is the coefficient on the $k^{%
\text{th}}$ covariate in $\mathbf{x}_{t}^{all}$ in the outcome equation ($%
\mathbf{\beta }_{k}^{all}$ is zero if the $k^{\text{th}}$ covariate in $%
\mathbf{x}_{t}^{all}$ is not included into the outcome equation).

The asymptotic standard errors of the MEs are computed using the Delta
method as the square roots of the diagonal elements of

\begin{center}
$\widehat{Var(\underset{}{\widehat{\mathbf{ME}}_{k,j,t}})}=\nabla _{\theta }%
\widehat{\mathbf{ME}}_{k,j,t}\widehat{Var(\widehat{\mathbf{\theta }})}\nabla
_{\theta }\widehat{\mathbf{ME}}_{k,j,t}^{^{\prime }}$.
\end{center}

\subsection{\noindent Relations among the models and their comparison}

We discuss now the choice of a formal statistical test to compare the NOP,
ZIOP-2, ZIOP-3 and conventional OP models. The choice depends on whether the
models are nested in each other.

The exogenous-switching version of each model is nested in its
endogenous-switching version as its uncorrelated special case; their
comparison can be performed using any classical lilkelihood-based test for
nested hypotheses, such as the likelihood ratio (LR) test.

The OP is not nested either in the NOP or ZIOP-3 model. We can compare the
OP model with them using a likelihood-based test for non-nested models, such
as the Vuong test (Vuong 1989). The OP model is however nested in the ZIOP-2
model. The latter reduces to the former if $\mu \rightarrow -\infty $;
hence, $\Pr (y_{t}=0|\mathbf{x}_{t},s_{t}^{\ast }=1)\rightarrow 0$.
Therefore, the Vuong test for non-nested hypothesis may not be used to
compare the OP and ZIOP-2 model: for nested hypothesis, the Voung test
reduces to the LR test. However, the critical values of the classical LR
test are invalid in this case since some standard regularity conditions of
the classical LR test fail to hold. In particular, the value of $\mu $ in
the null hypothesis is not an interior point of the parameter space; hence,
the asymptotic distribution of the LR statistics is not standard. Instead,
one may use the simulated adjusted critical values, which can be computed
following an algorithm provided in Andrews (2001).\footnote{%
Analogously, the use of the Vuong test for non-nested hypotheses, which is
implemented in the built-in STATA commands \texttt{zip} and \texttt{zinb} to
test for zero inflation in a Poisson or negative binomial model with a
binary regime equation is inappropriate too, because these models are
actually nested in their two-part zero-inflated extensions (Wilson 2015).}

The NOP model is nested in the ZIOP-3 model. The latter becomes the former
if $\alpha _{-1}^{-}\rightarrow \infty $ and $\alpha _{1}^{+}\rightarrow
-\infty $; therefore, $\Pr (y_{t}=0|\mathbf{x}_{t}^{+},s_{t}^{\ast
}=1)\rightarrow 0$ and $\Pr (y_{t}=0|\mathbf{x}_{t}^{-},s_{t}^{\ast
}=-1)\rightarrow 0$. The values of $\alpha _{-1}^{-}$ and $\alpha _{1}^{+}$
in the null hypothesis are not the interior points of the parameter space;
thus, the asymptotic distribution of the LR statistics is not standard. The
comparison of the NOP and ZIOP-3 models can also be performed using the LR
test with the simulated adjusted critical values following Andrews (2001).

Generally, the ZIOP-2 model is not a special case of the ZIOP-3 model, and
vice versa. We can compare them using the Vuong test. A special case when
the ZIOP-3 model nests the ZIOP-2 model emerges under some restrictions on
the parameters as explained below. In this case, the selection between the
ZIOP-3 and ZIOP-2 models can be performed using any classical
likelihood-based test for nested hypotheses such as the LR test.

The special case emerges if $y_{t}$ takes on only three discrete values $%
j\in \{-1,0,1\}$, the regressors in $\mathbf{x}_{t}^{-}$ and $\mathbf{x}%
_{t}^{+}$ in the outcome equations of the ZIOP-3 model contain all
regressors in the ZIOP-2 regime equation (denoted below by $\mathbf{z}_{2t}$
with the parameter vector $\mathbf{\gamma }_{2}$), and the regressors in the
regime equation of the ZIOP-3 model (denoted below by $\mathbf{z}_{3t}$ with
the parameter vector $\mathbf{\gamma }_{3}$) include all regressors in the $%
\mathbf{x}_{t}$ in the ZIOP-2 outcome equation. According to\ (\ref{Prob
MIOP}) the probabilities of the outcome $j$ in the ZIOP-2 model are given by

\begin{flushleft}
\begin{equation}
\begin{array}{l}
\Pr (y_{t}=-1|\mathbf{z}_{2t},\mathbf{x}_{t})=\Phi _{2}(-\mu +\mathbf{z}_{2t}%
\mathbf{\gamma }_{2};\alpha _{-1}-\mathbf{x}_{t}\mathbf{\beta };\mathbf{-}%
\rho ); \\ 
\\ 
\Pr (y_{t}=0|\mathbf{z}_{2t},\mathbf{x}_{t})=\Phi (\mu -\mathbf{z}_{2t}%
\mathbf{\gamma }_{2})+\Phi _{2}(-\mu +\mathbf{z}_{2t}\mathbf{\gamma }%
_{2};\alpha _{0}-\mathbf{x}_{t}\mathbf{\beta };\mathbf{-}\rho ) \\ 
-\Phi _{2}(-\mu +\mathbf{z}_{2t}\mathbf{\gamma }_{2};\alpha _{-1}-\mathbf{x}%
_{t}\mathbf{\beta };\mathbf{-}\rho )=1-\Phi _{2}(-\mu +\mathbf{z}_{2t}%
\mathbf{\gamma }_{2};-\alpha _{0}+\mathbf{x}_{t}\mathbf{\beta };\rho ) \\ 
-\Phi _{2}(-\mu +\mathbf{z}_{2t}\mathbf{\gamma }_{2};\alpha _{-1}-\mathbf{x}%
_{t}\mathbf{\beta };\mathbf{-}\rho ); \\ 
\\ 
\Pr (y_{t}=1|\mathbf{z}_{2t},\mathbf{x}_{t})=\Phi (-\mu +\mathbf{z}_{2t}%
\mathbf{\gamma })-\Phi _{2}(-\mu +\mathbf{z}_{2t}\mathbf{\gamma }_{2};\alpha
_{0}-\mathbf{x}_{t}\mathbf{\beta };\mathbf{-}\rho ) \\ 
=\Phi _{2}(-\mu +\mathbf{z}_{2t}\mathbf{\gamma }_{2};-\alpha _{0}+\mathbf{x}%
_{t}\mathbf{\beta };\rho ),%
\end{array}
\label{Prob spec ZIOP-2}
\end{equation}
\end{flushleft}

\noindent since $\Phi _{2}(x;y;\rho )=\Phi (x)-\Phi _{2}(x;-y;-\rho )$.

Similarly, according to (\ref{Prob CroNOP}) the probabilities of the outcome 
$j$ in the ZIOP-3 model are given by

\bigskip

$%
\begin{array}{l}
\Pr (y_{t}=-1|\mathbf{z}_{3t},\mathbf{x}_{t}^{-},\mathbf{x}_{t}^{+})=\Phi
_{2}(\mu _{1}-\mathbf{z}_{3t}\mathbf{\gamma }_{3};\alpha _{0}^{-}-\mathbf{x}%
_{t}^{-}\mathbf{\beta }^{-}\mathbf{;}\rho ^{-}); \\ 
\\ 
\Pr (y_{t}=0|\mathbf{z}_{3t},\mathbf{x}_{t}^{-},\mathbf{x}_{t}^{+})=\Phi
(\mu _{1}-\mathbf{z}_{3t}\mathbf{\gamma }_{3})-\Phi _{2}(\mu _{1}-\mathbf{z}%
_{3t}\mathbf{\gamma }_{3};\alpha _{0}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta }%
^{-}\mathbf{;}\rho ^{-}) \\ 
+\Phi (\mu _{2}-\mathbf{z}_{3t}\mathbf{\gamma }_{3})-\Phi (\mu _{1}-\mathbf{z%
}_{3t}\mathbf{\gamma }_{3})+\Phi _{2}(-\mu _{2}+\mathbf{z}_{3t}\mathbf{%
\gamma }_{3};\alpha _{0}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta }^{+};\mathbf{-}%
\rho ^{+}) \\ 
=\Phi _{2}(\mu _{1}-\mathbf{z}_{3t}\mathbf{\gamma }_{3};-\alpha _{0}^{-}+%
\mathbf{x}_{t}^{-}\mathbf{\beta }^{-}\mathbf{;-}\rho ^{-})+\Phi (\mu _{2}-%
\mathbf{z}_{3t}\mathbf{\gamma }_{3}) \\ 
-\Phi (\mu _{1}-\mathbf{z}_{3t}\mathbf{\gamma }_{3})+\Phi _{2}(-\mu _{2}+%
\mathbf{z}_{3t}\mathbf{\gamma }_{3};\alpha _{0}^{+}-\mathbf{x}_{t}^{+}%
\mathbf{\beta }^{+};\mathbf{-}\rho ^{+}); \\ 
\\ 
\Pr (y_{t}=1|\mathbf{z}_{3t},\mathbf{x}_{t}^{-},\mathbf{x}_{t}^{+})=\Phi
(-\mu _{2}+\mathbf{z}_{3t}\mathbf{\gamma }_{3})-\Phi _{2}(-\mu _{2}+\mathbf{z%
}_{3t}\mathbf{\gamma }_{3};\alpha _{0}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta }%
^{+};\mathbf{-}\rho ^{+}) \\ 
=\Phi _{2}(-\mu _{2}+\mathbf{z}_{3t}\mathbf{\gamma }_{3};-\alpha _{0}^{+}+%
\mathbf{x}_{t}^{+}\mathbf{\beta }^{+};\rho ^{+}). \\ 
\bigskip%
\end{array}%
$

Suppose the covariates in $\mathbf{x}_{t}^{-}$ and $\mathbf{x}_{t}^{+}$ in
the ZIOP-3 outcome equations are identical to the covariates in $\mathbf{z}%
_{2t}$ in the ZIOP-2 regime equation, the covariates in $\mathbf{z}_{3t}$ in
the ZIOP-3 regime equation are identical to the covariates in the $\mathbf{x}%
_{t}$ in the ZIOP-2 outcome equation, and the parameters are restricted as
follows: $-\mathbf{\beta }^{-}=\mathbf{\beta }^{+}=\mathbf{\gamma }_{2},$ $%
\mathbf{\beta }=\mathbf{\gamma }_{3},$ $\mu _{1}=\alpha _{-1},$ $\mu
_{2}=\alpha _{0},$ $-\alpha _{0}^{-}=\alpha _{0}^{+}=\mu $ and $-\rho
^{-}=\rho ^{+}=\rho $. Then, since $\mathbf{x}_{t}^{-}=\mathbf{x}_{t}^{+}=%
\mathbf{z}_{2t}$, $\mathbf{z}_{3t}=\mathbf{x}_{t}$ and $\Phi (-x)=1-\Phi (x)$%
, the probabilities for the ZIOP-3 model can be written as

\bigskip

$%
\begin{array}{l}
\Pr (y_{t}=-1|\mathbf{x}_{t},\mathbf{z}_{2t})=\Phi _{2}(\alpha _{-1}-\mathbf{%
x}_{t}\mathbf{\beta };-\mu +\mathbf{z}_{2t}\mathbf{\gamma }_{2}\mathbf{;-}%
\rho ); \\ 
\\ 
\Pr (y_{t}=0|\mathbf{x}_{t},\mathbf{z}_{2t})=\Phi _{2}(\alpha _{-1}-\mathbf{x%
}_{t}\mathbf{\beta };\mu -\mathbf{z}_{2t}\mathbf{\gamma }_{2}\mathbf{;}\rho
)+\Phi (\alpha _{0}-\mathbf{x}_{t}\mathbf{\beta })-\Phi (\alpha _{-1}-%
\mathbf{x}_{t}\mathbf{\beta }) \\ 
+\Phi _{2}(-\alpha _{0}+\mathbf{x}_{t}\mathbf{\beta };\mu -\mathbf{z}_{2t}%
\mathbf{\gamma }_{2};\mathbf{-}\rho )=-\Phi _{2}(\alpha _{-1}-\mathbf{x}_{t}%
\mathbf{\beta };-\mu +\mathbf{z}_{2t}\mathbf{\gamma }_{2}\mathbf{;-}\rho )+1
\\ 
-\Phi _{2}(-\alpha _{0}+\mathbf{x}_{t}\mathbf{\beta };-\mu +\mathbf{z}_{2t}%
\mathbf{\gamma }_{2};\rho ); \\ 
\\ 
\Pr (y_{t}=1|\mathbf{x}_{t},\mathbf{z}_{2t})=\Phi _{2}(-\alpha _{0}+\mathbf{x%
}_{t}\mathbf{\beta };-\mu +\mathbf{z}_{2t}\mathbf{\gamma }_{2};\rho ),%
\end{array}%
$

\bigskip

\noindent which are identical to the probabilities for the ZIOP-2 model in (%
\ref{Prob spec ZIOP-2}).

Notice that the restrictions $-\mathbf{\beta }^{-}=\mathbf{\beta }^{+}=%
\mathbf{\gamma }_{2}$ and $-\alpha _{0}^{-}=\alpha _{0}^{+}=\mu $ impose a
sort of symmetry in the ZIOP-3 model, because they imply that the
conditional probability of a positive response is equal to the conditional
probability of a negative response:

\medskip

\begin{gather*}
\Pr (y_{t}=1|\mathbf{z}_{3t},\mathbf{x}_{t}^{+},s_{t}^{\ast }=1)=1-\Phi
(\alpha _{0}^{+}-\mathbf{x}_{t}^{+}\mathbf{\beta }^{+})= \\
=\Phi (-\alpha _{0}^{+}+\mathbf{x}_{t}^{+}\mathbf{\beta }^{+})=\Phi (\alpha
_{0}^{-}-\mathbf{x}_{t}^{-}\mathbf{\beta }^{-})=\Pr (y_{t}=-1|\mathbf{z}_{t},%
\mathbf{x}_{t}^{-},s_{t}^{\ast }=-1)\text{.}
\end{gather*}

\medskip

In general, if $\mathbf{x}_{t}^{-}$ and $\mathbf{x}_{t}^{+}$ are not
identical to $\mathbf{z}_{2t}$ but contain all covariates in $\mathbf{z}%
_{2t} $, and if $\mathbf{z}_{3t}$ is not identical to $\mathbf{x}_{t}$ but
contains all covariates in $\mathbf{x}_{t}$, the ZIOP-2 model is still
nested in the ZIOP-3 model with the additional zero restrictions for the
coefficients on all the extra covariates in $\mathbf{x}_{t}^{-}$, $\mathbf{x}%
_{t}^{+}$ and $\mathbf{z}_{3t}$.

\section{The nop, ziop2 and ziop3 commands in Stata}

The accompanying software includes the three new commands, the
postestimation commands and the supporting help files.

\subsection{Syntax}

The following commands estimate, respectively, the NOP, ZIOP-2 and ZIOP-3
models for discrete ordinal outcomes:

\medskip

\hangindent=\parindent\noindent \texttt{nop $depvar$ [$indepvars\_reg$] [$if$%
] [$in$] [, \underline{\texttt{pos}}\_indepvars($varlist$) }

\texttt{\underline{\texttt{neg}}\_indepvars($varlist$) \underline{\texttt{inf%
}}cat($choice$) }\underline{\texttt{endo}}\texttt{switch cluster($varname$) }

\texttt{robust nolog vuong initial($string$)] }

\hangindent=\parindent\noindent \texttt{ziop2 $depvar$ [$indepvars\_reg$] [$%
if$] [$in$] [, \underline{\texttt{ind}}epvars($varlist$) \underline{\texttt{%
inf}}cat($choice$)}

\texttt{\underline{\texttt{endo}}switch cluster($varname$) robust nolog
initial($string$)] }

\hangindent=\parindent\noindent \texttt{ziop3 $depvar$ [$indepvars\_reg$] [$%
if$] [$in$] [, \underline{\texttt{pos}}\_indepvars($varlist$)}

\texttt{\underline{\texttt{neg}}\_indepvars($varlist$) \underline{\texttt{inf%
}}cat($choice$) \underline{\texttt{endo}}switch cluster($varname$) }

\texttt{robust nolog vuong initial($string$)]}

\medskip

An ordinal dependent variable \texttt{$depvar$} is assumed to take on at
least five discrete ordinal values in the NOP model, at least two --- in the
ZIOP-2 model, and at least three --- in the ZIOP-3 model. A list of the
covariates in the regime equation \texttt{$indepvars\_reg$} may be different
from the lists of the covariates in the outcome equations.

\subsubsection*{Options}

\hangindent=\parindent\noindent \texttt{\texttt{pos}\_indepvars($varlist$) }%
specifies a list of the covariates in the outcome equation conditional on
the regime $s_{t}^{\ast }=1$ for nonnegative outcomes in the NOP and ZIOP-3
models; by default, it is identical to \texttt{$indepvars\_reg$}, a list of
the covariates in the regime equation.

\smallskip

\hangindent=\parindent\noindent \texttt{neg\_indepvars($varlist$) }specifies
a list of the covariates in the outcome equation conditional on the regime $%
s_{t}^{\ast }=-1$ for nonpositive outcomes in the NOP and ZIOP-3 models; by
default, it is identical to \texttt{$indepvars\_reg$}, a list of the
covariates in the regime equation.

\smallskip

\hangindent=\parindent\noindent \texttt{indepvars($varlist$) }specifies a
list of the covariates in the outcome equation of the ZIOP-2 model; by
default, it is identical to \texttt{$indepvars\_reg$}, a list of the
covariates in the regime equation.

\smallskip

\hangindent=\parindent\noindent \texttt{infcat($choice$) }is a value of the
dependent variable in the regime $s_{t}^{\ast }=0$ that should be modeled as
inflated in the ZIOP-2 and ZIOP-3 models, and as neutral in the NOP model;
by default, it equals 0.

\smallskip

\hangindent=\parindent\noindent \texttt{endoswitch }specifies that
endogenous regime switching is to be used instead of default exogenous
switching. Regime switching is endogenous if the unobserved random term in
the regime equation is correlated with the unobserved random terms in the
outcome equations, and exogenous otherwise.

\smallskip

\hangindent=\parindent\noindent \texttt{robust }specifies that a robust
sandwich estimator of variance is to be used; the default estimator is based
on the observed information matrix.

\smallskip

\hangindent=\parindent\noindent \texttt{cluster($varname$) }specifies a
clustering variable for the clustered robust sandwich estimator of variance.

\smallskip

\hangindent=\parindent\noindent \texttt{initial($string$) }specifies a
space-delimited list \texttt{$string$} of the starting values of the
parameters in the following order: $\mathbf{\gamma ,}$ $\mathbf{\mu ,}$ $%
\mathbf{\beta }^{+},$ $\mathbf{\alpha }^{+},$ $\mathbf{\beta }^{-},$ $%
\mathbf{\alpha }^{-},$ $\rho ^{-}$ and $\rho ^{+}$ for the NOP and ZIOP-3
models, and $\mathbf{\gamma },$ $\mu ,$ $\mathbf{\beta },$ $\mathbf{\alpha }$
and $\rho $ for the ZIOP-2 model.

\smallskip

\hangindent=\parindent\noindent \texttt{vuong }specifies that the Vuong test
of NOP (or ZIOP-3) model versus the conventional OP model should be
performed. The command computes the three Vuong test statistics, the
standard statistic $z=(s_{\Delta l}\sqrt{T})^{-1}\sum_{i=1}^{T}\Delta l_{i}$
and the two adjusted ones, $z_{AIC}=(s_{\Delta l}\sqrt{T})^{-1}%
\sum_{i=1}^{T}\Delta l_{i}+(K_{1}-K_{2})$ and $z_{BIC}=(s_{\Delta l}\sqrt{T}%
)^{-1}\sum_{i=1}^{T}\Delta l_{i}+(K_{1}-K_{2})\ln (T)/2$, with corrections
based on the Akaike information criterion (AIC) (Akaike 1974) and the
Bayesian (Schwarz) information criterion (BIC) (Schwarz 1978), where $\Delta
l_{i}$ is the difference in the $i^{\text{th}}$ observation's individual
contribution to the log-likelihoods of two models, $s_{\Delta l}$ is the
standard deviation of the differences in the observation-wise
log-likelihoods, and $K_{1}$ and $K_{2}$ are the numbers of parameters in
each of the two models. The reported $z$-statistics have a standard normal
distribution with large positive values favoring the NOP (or ZIOP-3) model
and large negative values favoring the OP model. An insignificant statistic
implies no preference for either model. For the ZIOP-2 model this option is
not available since the Vuong test is not appropriate in this case as
explained in Section 2.7.

\smallskip

\hangindent=\parindent\noindent \texttt{nolog }suppresses the iteration log.

\subsubsection*{Stored results}

The descriptions of the stored results can be found in the help files.

\subsection{Postestimation commands}

The following postestimation commands are available after \texttt{nop}, 
\texttt{ziop2} and \texttt{ziop3}:

\subsubsection*{The predict command}

\hangindent=\parindent\noindent \texttt{predict $varname$ [$if$] [$in$] [,
zeros regimes output($string$)]}

\smallskip

This command computes either the predicted probabilities of discrete choices
(by default), or the predicted probabilities of the regimes or the types of
zeros conditional on the regime, or the expected values of the dependent
variable. The command creates $(J^{-}+J^{+}+1)$ new variables under the
names with a \texttt{$varname$} prefix. The following options are available:

\smallskip

\smallskip \hangindent=\parindent\noindent \texttt{regimes} indicates that
the probabilities of the regimes $s_{t}\in \{-1,0,1\}$ must be predicted
instead of the choice probabilities. This option is ignored if the \texttt{%
zeros} option is used.

\medskip

\hangindent=\parindent\noindent \texttt{zeros} indicates that the
probabilities of the different types of zeros (the outcomes in the inflated
category), conditional on different regimes, must be predicted instead of
the choice probabilities.

\smallskip

\hangindent=\parindent\noindent \texttt{output($string$)} specifies the
different types of predictions. The possible values of \texttt{$string$}
are: \texttt{$choice$}\ for reporting the predicted outcome (the choice with
the largest predicted probability); \texttt{$mean$} for reporting the
expected value of the dependent variable computed as $\sum_{i}i\Pr (y_{t}=i)$%
; and \texttt{$cum$}\ for predicting the cumulative choice probabilities: $%
\Pr (y_{t}<=-J^{-})$, $\Pr (y_{t}<=-J^{-}+1)$, ..., $\Pr (y_{t}<=J^{+})$. If 
\texttt{$string$ }is not specified, the usual choice probabilities $\Pr
(y_{t}=-J^{-})$, $\Pr (y_{t}=-J^{-}+1)$, ..., $\Pr (y_{t}=J^{+})$ are
predicted and saved into the new variables with a \texttt{$varname$} prefix.

\subsubsection*{The ziopprobabilities command}

\hangindent=\parindent\noindent \texttt{ziopprobabilities [, at($string$)
zeros regimes]}

\smallskip

This command shows the predicted probabilities estimated for the specified
values of the covariates along with the standard errors. The options \texttt{%
zeros} and\texttt{\ regimes} are specified as in \texttt{predict}. The
option \texttt{at}() is specified as follows:\smallskip

\hangindent=\parindent\noindent \texttt{at($string$)} specifies for which
values of the covariates to estimate the predictions. If \texttt{at($string$)%
} is used (\texttt{$string$} is a list of \texttt{$varname=value$}
expressions, separated by commas), the predictions are estimated for these
values and displayed without saving to the dataset. If some covariate names
are not specified, their median values are taken instead. If \texttt{at()}
is not used, by default the predictions are estimated for the covariate
median values.

\subsubsection*{The ziopcontrasts command}

\texttt{ziopcontrasts [, at($string$) to($string$) zeros regimes] }

\smallskip

This command shows the differences in the predicted choice probabilities,
estimated first for the values of the covariates in \texttt{at()} and then
in \texttt{to()}, along with the standard errors. The options \texttt{zeros},%
\texttt{\ regimes} and \texttt{at()} are specified as in \texttt{%
ziopprobabilities}. The options \texttt{to()} is specified analogously to 
\texttt{at()}.

\subsubsection*{The ziopmargins command}

\hangindent=\parindent\noindent \texttt{ziopmargins [, at($string$) zeros
regimes]}

\smallskip

This command shows the marginal effects of each covariate on the choice
probabilities estimated for the specified values of the covariates along
with the standard errors. The options \texttt{zeros},\texttt{\ regimes} and 
\texttt{at()} are specified as in \texttt{ziopprobabilities}.

\subsubsection*{The ziopclassification command}

\texttt{ziopclassification [$if$] [$in$]}

\smallskip

This command shows: the classification table (or confusion matrix); the
percentage of correct predictions; the two strictly proper scores --- the
probability, or Brier, score (Brier 1950) and the ranked probability score
(Epstein 1969); the precisions, the hit rates (or recalls) and the adjusted
noise-to-signal\ ratios (Kaminsky and Reinhart 1999).

The classification table reports the predicted choices (ones with the
highest predicted probability) in columns, the actual choices in rows, and
the number of (mis)classifications in each cell.

The Brier probability score is computed as $\frac{1}{T}\sum_{t=1}^{T}%
\sum_{j=-J^{-}}^{J^{+}}[\Pr (y_{t}=j)-I_{jt}]^{2}$, where indicator $%
I_{jt}=1 $ if $y_{t}=j$ and $I_{jt}=0$ otherwise. The ranked probability
score is computed as $\frac{1}{T}\sum_{t=1}^{T}%
\sum_{j=-J^{-}}^{J^{+}}[Q_{jt}-D_{jt}]^{2}$, where $Q_{jt}=%
\sum_{i=-J^{-}}^{j}\Pr (y_{t}=i)$ and $D_{jt}=\sum_{i=-J^{-}}^{j}I_{it}$.
The better the prediction, the smaller both score values. Both scores have a
minimum value of zero when all the actual outcomes are predicted with a unit
probability.

The precision, the hit rate (or recall) and the adjusted noise-to-signal\
ratios are defined as follows. Let \emph{TP} denote the true positive event
that the outcome was predicted and occurred; let \emph{FP} denote the false
positive event that the outcome was predicted but did not occur; let \emph{FN%
} denote the false positive event that the outcome was not predicted but
occurred; and let \emph{TN} denote the true negative event that the outcome
was not predicted and did not occur. The desirable outcomes fall into
categories \emph{TP} and \emph{TN}, while the noisy ones fall into
categories \emph{FP} and \emph{FN}. A perfect prediction has no entries in 
\emph{FP} and \emph{FN}, while a noisy prediction has many entries in \emph{%
FP }and \emph{FN}, but few in \emph{TP} and \emph{TN}. The precision is
defined for each choice as \emph{TP}/(\emph{TP}+\emph{FP}), the recall ---
as \emph{TP}/(\emph{TP}+\emph{FN}), and the adjusted noise-to-signal\ ratio
--- as [\emph{FP}/(\emph{FP}+\emph{TN})]/[\emph{TP}/(\emph{TP}+\emph{FN})].

\subsubsection*{The ziopvuong command}

\texttt{ziopvuong $modelspec_{1}$ $modelspec_{2}$}

\smallskip

This command performs the Vuong test for non-nested hypotheses, which
compares the closeness of two models to the true data distribution using the
differences in the observation-wise log-likelihoods of the two models. The
arguments \texttt{$modelspec_{1}$} and \texttt{$modelspec_{2}$} are the
names under which the estimation results are saved using the \texttt{%
estimates store} command. Any model that stores the vector \texttt{e(ll\_obs)%
} of observation-wise log-likelihoods technically can be used to perform the
test. The command shows the three Vuong test $z$-statistics, computed as in
the \texttt{vuong} option of the \texttt{nop} and \texttt{ziop3} commands.
These statistics can be used to test the hypothesis that one of the models
explains the data better than the other. A significant positive $z$%
-statistic indicates a preference for the first model, while a significant
negative value indicates a preference for the second model. An insignificant 
$z$-statistic implies no preference for either model.

\section{Monte Carlo simulations}

We conducted the extensive Monte Carlo experiments to illustrate the finite
sample performance of the ML estimators of each model.

\subsection{Monte Carlo design}

We simulated six processes generated by the NOP, ZIOP-2 and ZIOP-3 models,
each of them with both exogenous and endogenous switching. The repeated
samples with 200, 500 and 1,000 observations were independently generated
and then estimated by the true model. The number of replications was 10,000
in each experiment.

Three covariates $\mathbf{w}_{\mathbf{1}}$, $\mathbf{w}_{\mathbf{2}}$ and $%
\mathbf{w}_{\mathbf{3}}$ were drawn in each replication as\noindent\ $%
\mathbf{w}_{\mathbf{1}}\overset{\emph{iid}}{\sim }\mathcal{N}(0,1)+2$, $%
\mathbf{w}_{\mathbf{2}}\overset{\emph{iid}}{\sim }\mathcal{N}(0,1$), and $%
\mathbf{w}_{\mathbf{3}}=-1$ if $\mathbf{u}\leq 0.3$, $0$ if $0.3<\mathbf{u}%
\leq 0.7$, or $1$ if $\mathbf{u}>0.7$, where $\mathbf{u}\overset{\emph{iid}}{%
\sim }\mathcal{U}[0,1]$. The repeated samples were generated for the NOP and
ZIOP-3 models\textit{\ }with $\mathbf{Z=(w_{1}},\mathbf{w_{2}}$), $\mathbf{%
\mathbf{X}^{-}=(w_{1}},\mathbf{w_{3}}$), $\mathbf{\mathbf{X}^{+}=(w_{2}},%
\mathbf{w_{3}}$), and for the ZIOP-2 model with $\mathbf{Z=(w}_{1},\mathbf{w}%
_{3})$, $\mathbf{\mathbf{X}=(w}_{2},\mathbf{w}_{3})$. The dependent variable 
$y$ was generated with five values: -2, -1, 0, 1 and 2. The parameters were
calibrated to yield on average the following frequencies of the above
outcomes: 7\%, 14\%, 58\%, 14\% and 7\%, respectively. To avoid the
divergence of ML estimates due to the problem of complete separation
(perfect prediction), which could happen if the actual number of
observations in any outcome category is very low, the samples with any
outcome category frequency lower than 6\% were re-generated. The variances
of the error terms in all equations were fixed to one. The true values of
all other parameters in the simulations are shown in Table \ref{True param}
in Appendix. The starting values for the slope and threshold parameters were
obtained using the independent OP estimations of each equation. The starting
values for $\rho $, $\rho ^{-}$ and $\rho ^{+}$ were obtained by maximizing
the likelihood functions of the endogenous-switching models holding the
other parameters fixed at their estimates in the corresponding
exogenous-switching model. The values of the choice probabilities, which
depend on the values of the regressors, are computed at the population
medians of the covariates.

\subsection{Monte Carlo results}

Table \ref{MC_results} reports the measures of accuracy for the estimates of
the choice probabilities. The results for the estimates of the parameters
and MEs are qualitatively and quantitatively similar. The simulations show
that the ML estimators are consistent and reliable even in samples with only
200 observations: the biases of choice probability estimates are smaller
than five percent and the asymptotic coverage rates differ from the nominal
0.95 level by less than one percent. For each model, the bias and RMSE
decrease as sample size increases. The RMSE decreases in most cases faster
than the asymptotic rate $\sqrt{n}$. This may be caused by a small number of
large deviations in parameter estimation in small samples. For all models
and sample sizes, the bias and RMSE are expectedly slightly higher for a
more complex endogenous-switching version. The standard error estimates on
average correspond to the actual standard errors; however, large deviations
make standard error estimates biased in small samples, but do not move the
coverage rates from the nominal level by more than one percent even with
only 200 observations. The accuracy in the NOP models is expectedly higher
than in the zero-inflated OP models.

\medskip

%TCIMACRO{%
%\TeXButton{B}{\begin{table}[H]\captionsetup{singlelinecheck = false, justification=justified}}}%
%BeginExpansion
\begin{table}[H]\captionsetup{singlelinecheck = false, justification=justified}%
%EndExpansion
\caption{Monte Carlo results: The accuracy of ML
estimators\label{MC_results}}%
%TCIMACRO{\TeXButton{TeX field}{\centering}}%
%BeginExpansion
\centering%
%EndExpansion

\begin{center}
%TCIMACRO{%
%\FRAME{itbpF}{6.2349in}{2.9481in}{0in}{}{}{Figure}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "T";width 6.2349in;height 2.9481in;depth 0in;original-width 6.2075in;original-height 2.9199in;cropleft "0";croptop "1";cropright "1";cropbottom "0";tempfilename 'P8RJ9U00.wmf';tempfile-properties "XPR";}}}%
%BeginExpansion
\includegraphics[
natheight=2.9199in, natwidth=6.2075in, height=2.9481in, width=6.2349in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/P8RJ9U00__2.pdf}%
%EndExpansion
\end{center}

%TCIMACRO{\TeXButton{TeX field}{\justify}}%
%BeginExpansion
\justify%
%EndExpansion
%TCIMACRO{\TeXButton{TeX field}{\footnotesize}}%
%BeginExpansion
\footnotesize%
%EndExpansion

Notes: Bias -- the absolute difference between the estimated and true
values, divided by the true value; RMSE -- the absolute root mean square
error of the estimates; Coverage rate -- the percentage of times the
estimated asymptotic 95\% confidence intervals cover the true values; Bias
of standard error estimates -- the absolute difference between the average
of the estimated asymptotic standard errors of the estimates and the
standard deviation of the estimates in all replications. The above measures
are averaged across five outcome categories.

%TCIMACRO{\TeXButton{E}{\end{table}}}%
%BeginExpansion
\end{table}%
%EndExpansion

\section{Examples}

The new commands are applied to a real-world time-series sample of all
decisions of the U.S. Federal Open Market Committee (FOMC) on the federal
funds rate target made at the scheduled and unscheduled meetings during the
9/1987 -- 9/2008 period.

The dependent variable, the change to the rate target, is classified into
five ordered categories: \textquotedblleft -0.5\textquotedblright\ (a cut of
0.5\% or more), \textquotedblleft -0.25\textquotedblright\ (a cut less than
0.5\% but more than 0.0625\%), \textquotedblleft 0\textquotedblright\ (no
change or change by no more than 0.0625\%), \textquotedblleft
0.25\textquotedblright\ (a hike more than 0.0625\% but less than 0.5\%) and
\textquotedblleft 0.5\textquotedblright\ (a hike of 0.5\% or more). The FOMC
decisions are aligned with the real-time values of the explanatory variables
as they were truly available to the public on the previous day before each
FOMC meeting. The explanatory variables include: \texttt{spread} (the
difference between the one-year treasury constant maturity rate and the
effective federal funds rate, five-business-day moving average; data source:
ALFRED\footnote{%
ALFRED (ArchivaL Federal Reserve Economic Data) is available at
https://alfred.stlouisfed.org/.}); \texttt{pb} (the trichotomous indicator
that we constructed from the \textquotedblleft policy
bias\textquotedblright\ statements at the previous FOMC meeting: it equals 1
if the statement was asymmetric toward tightening, 0 if the statement was
symmetric, and -1 if the statement was asymmetric toward easing; data
source: FOMC statements and minutes\footnote{%
https://www.federalreserve.gov/monetarypolicy/fomc\_historical.htm.}); 
\texttt{houst} (the Greenbook\ projection for the current quarter of the
total number of new privately owned housing units started; data source: RTDSM%
\footnote{%
RTDSM (Real-Time Data Set for Macroeconomists) is available at
https://www.philadelphiafed.org.}); \texttt{gdp} (the Greenbook projection
for the current quarter of quarterly growth in the nominal gross domestic
(before 1992: national) product, annualized percentage points; data source:
RTDSM).

We start by estimating the conventional OP model using the \texttt{oprobit}
command:

\medskip

%TCIMACRO{%
%\FRAME{itbpF}{5.0693in}{4.308in}{0in}{}{}{op.png}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "F";width 5.0693in;height 4.308in;depth 0in;original-width 5.0485in;original-height 2.8319in;cropleft "0";croptop "1";cropright "1";cropbottom "0";filename 'OP.png';file-properties "XNPEU";}}}%
%BeginExpansion
\includegraphics[
natheight=2.8319in, natwidth=5.0485in, height=4.308in, width=5.0693in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/OP__3.png}%
%EndExpansion

\medskip

We now allow the negative, zero and positive changes to the rate target to
be generated by different processes, and estimate the three-part NOP model.
The \texttt{nop} command yields the following results:

\medskip

%TCIMACRO{%
%\FRAME{itbpF}{5.7559in}{5.3649in}{0in}{}{}{nop.png}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "F";width 5.7559in;height 5.3649in;depth 0in;original-width 5.7285in;original-height 5.3358in;cropleft "0";croptop "1";cropright "1";cropbottom "0";filename 'NOP.png';file-properties "XNPEU";}}}%
%BeginExpansion
\includegraphics[
natheight=5.3358in, natwidth=5.7285in, height=5.3649in, width=5.7559in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/NOP__4.png}%
%EndExpansion

\bigskip

The NOP model provides a substantial improvement of the likelihood, and is
preferred to the standard OP model according to the AIC and the Vuong test
(the $p$-value is 0.01). However, the Vuong tests with the corrections based
on the AIC and BIC are indifferent between the two models. The endogenous
switching does not significantly improve the likelihood of the NOP model
(the log likelihood with endogenous switching is -150.2, the $p$-value of
the LR test of the null of exogenous switching is 0.48), the correlation
coefficients $\rho ^{-}$and $\rho ^{+}$ are not significant, and both the
AIC and BIC favor the NOP model with exogenous switching.

Next we allow for an inflation of zero outcomes and estimate the three-part
ZIOP-3 model. The \texttt{ziop3 }command with exogenous switching yields the
following results:

\medskip \pagebreak

%TCIMACRO{%
%\FRAME{itbpF}{5.8198in}{0.396in}{0in}{}{}{ziop3command.png}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "F";width 5.8198in;height 0.396in;depth 0in;original-width 5.7999in;original-height 0.1519in;cropleft "0";croptop "1";cropright "1";cropbottom "0";filename 'ZIOP3command.png';file-properties "XNPEU";}}}%
%BeginExpansion
\includegraphics[
natheight=0.1519in, natwidth=5.7999in, height=0.396in, width=5.8198in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/ZIOP3command__5.png}%
%EndExpansion

\smallskip 
%TCIMACRO{%
%\FRAME{itbpF}{5.628in}{5.5176in}{0in}{}{}{ziop3.png}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "F";width 5.628in;height 5.5176in;depth 0in;original-width 5.5998in;original-height 5.4886in;cropleft "0";croptop "1";cropright "1";cropbottom "0";filename 'ZIOP3.png';file-properties "XNPEU";}}}%
%BeginExpansion
\includegraphics[
natheight=5.4886in, natwidth=5.5998in, height=5.5176in, width=5.628in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/ZIOP3__6.png}%
%EndExpansion

\bigskip

The empirical evidence in favor of zero inflation is convincing: with only
two extra parameters, the ZIOP-3 model has much higher likelihood than the
NOP model (-139.6 vs. -151.0), and is clearly preferred by both the AIC and
the BIC to the NOP and OP models. The Vuong tests for zero inflation ( the
standard one and one with the correction based on the AIC) favor the ZIOP-3
model over the OP model at the 0.001 and 0.01 level, respectively. The
endogenous switching does not significantly improve the likelihood of the
ZIOP-3 model either (the $p$-value of the LR test of exogenous switching is
0.30, and both the AIC and BIC prefer the exogenous switching).

In contrast, the likelihood of the two-part ZIOP-2 model is even lower than
that of the NOP model. According both to the AIC and BIC, the ZIOP-2 model
is inferior to all the above models, including the OP one. The \texttt{ziop2 
}command yields the following results:

\bigskip

%TCIMACRO{%
%\FRAME{itbpF}{5.7086in}{3.7011in}{0in}{}{}{ziop2.png}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "F";width 5.7086in;height 3.7011in;depth 0in;original-width 5.6803in;original-height 3.672in;cropleft "0";croptop "1";cropright "1";cropbottom "0";filename 'ZIOP2.png';file-properties "XNPEU";}}}%
%BeginExpansion
\includegraphics[
natheight=3.672in, natwidth=5.6803in, height=3.7011in, width=5.7086in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/ZIOP2__7.png}%
%EndExpansion

\bigskip

The Vuong tests prefer the ZIOP-3 model to the ZIOP-2 model at the 0.01
significance level using the standard test statistic, and at the 0.02 and
0.03 level using the corrections based, respectively, on the AIC and BIC:

\medskip

%TCIMACRO{%
%\FRAME{itbpF}{5.6197in}{2.8045in}{0in}{}{}{vuong.png}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "F";width 5.6197in;height 2.8045in;depth 0in;original-width 5.5915in;original-height 2.7754in;cropleft "0";croptop "1";cropright "1";cropbottom "0";filename 'Vuong.png';file-properties "XNPEU";}}}%
%BeginExpansion
\includegraphics[
natheight=2.7754in, natwidth=5.5915in, height=2.8045in, width=5.6197in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/Vuong__8.png}%
%EndExpansion

\bigskip

Now we report the selected output of the postestimation commands, performed
for the ZIOP-3 model.

The predicted choice probabilities and their standard errors, estimated at
the specified values of the covariates, can be computed using the \texttt{%
ziopprobabilities} command:

\medskip

%TCIMACRO{%
%\FRAME{itbpF}{4.2524in}{2.1727in}{0in}{}{}{probabilities.jpg}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "F";width 4.2524in;height 2.1727in;depth 0in;original-width 4.2241in;original-height 2.1445in;cropleft "0";croptop "1";cropright "1";cropbottom "0";filename 'Probabilities.jpg';file-properties "XNPEU";}}}%
%BeginExpansion
\includegraphics[
natheight=2.1445in, natwidth=4.2241in, height=2.1727in, width=4.2524in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/Probabilities__9.jpg}%
%EndExpansion

\bigskip

The predicted probabilities of the three latent regimes $s_{t}^{\ast }\in
\{-1,0,1\}$ or the probabilities of the three types of zeros conditional on
each regime can be estimated for each sample observation using the command 
\texttt{predict} with the option \texttt{zeros} or \texttt{regimes}:

\bigskip

%TCIMACRO{%
%\FRAME{itbpF}{4.5737in}{1.4197in}{0in}{}{}{prob_zero_reg.png}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "F";width 4.5737in;height 1.4197in;depth 0in;original-width 4.5438in;original-height 1.3914in;cropleft "0";croptop "1";cropright "1";cropbottom "0";filename 'Prob_zero_reg.png';file-properties "XNPEU";}}}%
%BeginExpansion
\includegraphics[
natheight=1.3914in, natwidth=4.5438in, height=1.4197in, width=4.5737in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/Prob_zero_reg__10.png}%
%EndExpansion

\bigskip

The average predicted probabilities of the regimes $s_{t}=-1$, $s_{t}=0$ and 
$s_{t}=1$ in the sample are 0.40, 0.39 and 0.21, respectively. However, the
average probability of zeros conditional on the regime $s_{t}=-1$ (0.15) is
much higher than on the regime $s_{t}=1$ (0.00).

The marginal effects of the covariates on the choice probabilities and their
standard errors, evaluated at the specified values of the covariates, can be
computed using the \texttt{ziopmargins} command:

\bigskip

%TCIMACRO{%
%\FRAME{itbpF}{5.0602in}{2.9082in}{0in}{}{}{margins.png}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "F";width 5.0602in;height 2.9082in;depth 0in;original-width 5.0319in;original-height 2.88in;cropleft "0";croptop "1";cropright "1";cropbottom "0";filename 'Margins.png';file-properties "XNPEU";}}}%
%BeginExpansion
\includegraphics[
natheight=2.88in, natwidth=5.0319in, height=2.9082in, width=5.0602in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/Margins__11.png}%
%EndExpansion

\bigskip

The differences in the predicted choice probabilities (along with the
standard errors) computed at two different values of the covariates can be
estimated using the \texttt{ziopcontrasts} command. In particular, this
command may be used to compute the MEs of the discrete ordinal covariates
such as \texttt{pb} (instead of using the \texttt{ziopmargins} command,
which computes the derivatives of the probabilities):

\bigskip

%TCIMACRO{%
%\FRAME{itbpF}{4.1561in}{2.2773in}{0in}{}{}{contrasts.png}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "F";width 4.1561in;height 2.2773in;depth 0in;original-width 6.5355in;original-height 2.0556in;cropleft "0";croptop "1";cropright "1";cropbottom "0";filename 'Contrasts.png';file-properties "XNPEU";}}}%
%BeginExpansion
\includegraphics[
natheight=2.0556in, natwidth=6.5355in, height=2.2773in, width=4.1561in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/Contrasts__12.png}%
%EndExpansion

\bigskip

Finally, the different measures of the model fit and the accuracy of the
probabilistic predictions can be computed using the \texttt{%
ziopclassification} command:

\bigskip

%TCIMACRO{%
%\FRAME{itbpF}{5.1in}{3.6189in}{0in}{}{}{classification.png}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "F";width 5.1in;height 3.6189in;depth 0in;original-width 5.0718in;original-height 3.5915in;cropleft "0";croptop "1";cropright "1";cropbottom "0";filename 'Classification.png';file-properties "XNPEU";}}}%
%BeginExpansion
\includegraphics[
natheight=3.5915in, natwidth=5.0718in, height=3.6189in, width=5.1in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/Classification__13.png}%
%EndExpansion

\bigskip

As Table \ref{Compar} reports, the ZIOP-3 model demonstrates the best fit
according to all the employed criteria.

\bigskip

%TCIMACRO{%
%\TeXButton{B}{\begin{table}[H]\captionsetup{singlelinecheck = false, justification=justified}}}%
%BeginExpansion
\begin{table}[H]\captionsetup{singlelinecheck = false, justification=justified}%
%EndExpansion
\caption{Comparison of the alternative models\label{Compar}}%
%TCIMACRO{\TeXButton{TeX field}{\centering}}%
%BeginExpansion
\centering%
%EndExpansion

\begin{center}
%TCIMACRO{%
%\FRAME{itbpF}{6.1328in}{1.941in}{0in}{}{}{Figure}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "T";width 6.1328in;height 1.941in;depth 0in;original-width 6.1037in;original-height 1.912in;cropleft "0";croptop "1";cropright "1";cropbottom "0";tempfilename 'P8RJ9W01.wmf';tempfile-properties "XPR";}}}%
%BeginExpansion
\includegraphics[
natheight=1.912in, natwidth=6.1037in, height=1.941in, width=6.1328in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/P8RJ9W01__14.pdf}%
%EndExpansion
\end{center}

\smallskip 
%TCIMACRO{\TeXButton{TeX field}{\justify}}%
%BeginExpansion
\justify%
%EndExpansion
%TCIMACRO{\TeXButton{TeX field}{\footnotesize}}%
%BeginExpansion
\footnotesize%
%EndExpansion

%TCIMACRO{\TeXButton{E}{\end{table}}}%
%BeginExpansion
\end{table}%
%EndExpansion

\section{\noindent \noindent Concluding remarks}

This article describes the ML estimation of the nested and cross-nested
zero-inflated ordered probit models using the new STATA commands \texttt{nop}%
, \texttt{ziop2} and \texttt{ziop3}. Such models can be applied to a variety
of data sets in which the discrete ordinal outcomes can be divided into the
groups (nests) of similar choices, for example, the decisions to reduce, or
leave unchanged, or increase the choice variable (monetary policy interest
rates, rankings, prices, consumption levels), or the negative, or neutral,
or positive attitudes to the survey questions. The choice among the nests is
driven by an ordered-choice switching mechanism that can be either exogenous
or endogenous to the outcome decisions, which are also naturally ordered
(large or small increase/decrease; disagree or strongly disagree; etc.). The
models allow the probabilities of choices from different nests (e.g., no
change and an increase) to be driven by distinct mechanisms. Moreover, the
cross-nested zero-inflated models allow the often abundant no-change or
neutral outcomes to belong to all nests and be inflated by several different
processes. The results of Monte Carlo simulations indicate that the proposed
ML estimators are consistent and perform well in small samples.

\section{Acknowledgments}

We gratefully acknowledge financial support from the Basic Research Program
of the National Research University Higher School of Economics in Moscow.

\noindent

\begin{thebibliography}{99}
\bibitem{} Akaike, H. 1974. A new look at the statistical model
identification. \textit{IEEE Transactions on Automatic Control} 19: 716--723.

\bibitem{} Andrews, D. W. K. 2001. Testing when a parameter is on the
boundary of the maintained hypothesis.\ \textit{Econometrica} 69 (3):
683--734.

\bibitem{} Bagozzi, B. E., and B. Mukherjee. 2012. A mixture model for
middle category inflation in ordered survey responses.\ \textit{Political
Analysis\ }20: 369--386.

\bibitem{} Basu, D., and R. M. de Jong. 2007. Dynamic multinomial ordered
choice with an application to the estimation of monetary policy rules.\ 
\textit{Studies in Nonlinear Dynamics and Econometrics} 11 (4): 1--35.

\bibitem{} Brier, G. W.\ 1950. Verification of forecasts expressed in terms
of probability.\ \textit{Monthly Weather Review} 78 (1): 1--3.

\bibitem{} Brooks, R., M. N. Harris, and C. Spencer. 2012. Inflated ordered
outcomes.\ \textit{Economics Letters} 117 (3): 683--686.

\bibitem{} Epstein, E. S. 1969. A scoring system for probability forecasts
of ranked categories.\ \textit{Journal of Applied Meteorology} 8: 985--987.

\bibitem{} Famoye, F., and K. P. Singh. 2003. On inflated generalized
Poisson regression models. \textit{Advanced Applied Statistics} 3 (2):
145--158.

\bibitem{} Greene, W. H. 1994. Accounting for excess zeros and sample
selection in Poisson and negative binomial regression models.\ Working Paper
No. 94-10, Department of Economics, Stern School of Business, New York
University.

\bibitem{} Greene, W. H., and D. A. Hensher. 2010. \textit{Modeling ordered
choices: A primer}.\ Cambridge University Press.

\bibitem{} Hardin, J. W., and J. M. Hilbe. 2014. Estimation and testing of
binomial and beta-binomial regression models with and without zero
inflation. \textit{Stata Journal} 14(2): 292-303.

\bibitem{} Harris, M. N., and X. Zhao. 2007. A zero-inflated ordered probit
model, with an application to modelling tobacco consumption.\ \textit{%
Journal of Econometrics} 141 (2): 1073--1099.

\bibitem{} Heckman, J. J. 1978. Dummy endogenous variables in a simultaneous
equation system. \textit{Econometrica} 46: 931--959.

\bibitem{} Hern\'{a}ndez, A., F. Drasgow, and V. Gonz\'{a}les-Rom\'{a}.
2004. Investigating the functioning of a middle category by means of a
mixed-measurement model. \textit{Journal of Applied Psychology} 89 (4):
687-699.

\bibitem{} Kaminsky, G. L., and C. M. Reinhart. 1999. The twin crises: the
causes of banking and balance-of-payments problems.\ \textit{American
Economic Review} 89 (3): 473--500.

\bibitem{} Kelley, M. E., and S. J. Anderson. 2008. Zero inflation in
ordinal data: incorporating susceptibility to response through the use of a
mixture model.\ \textit{Statistics in Medicine} 27: 3674--3688.

\bibitem{} Kulas, J. T., and A. A. Stachowski. 2009. Middle category
endorsement in odd-numbered Likert response scales: Associated item
characteristics, cognitive demands, and preferred meanings. \textit{Journal
of Research in Personality }43: 489-493.

\bibitem{} Lambert, D. 1992. Zero-inflated Poisson regression with an
application to defects in manufacturing.\ \textit{Technometrics} 34 (1):
1--14.

\bibitem{} Sirchenko, A. 2013. A model for ordinal responses with an
application to policy interest rate. National Bank of Poland Working Paper
No. 148.

\bibitem{} Small, K. 1987. A discrete choice model for ordered
alternatives.\ \textit{Econometrica} 55: 409--424.

\bibitem{} Schwarz, G. 1978. Estimating the dimension of a model. \textit{%
Annals of Statistics} 6: 461--464.

\bibitem{} Vovsha, P. 1997. Application of cross-nested logit model to mode
choice in Tel Aviv, Israel, Metropolitan Area.\ \textit{Transportation
Research Record} 1607: 6--15.

\bibitem{} Vuong, Q. 1989. Likelihood ratio tests for model selection and
non-nested hypotheses.\ \textit{Econometrica} 57 (2): 307--333.

\bibitem{} Wen, C.-H., and F. Koppelman. 2001. The generalized nested logit
model. \textit{Transportation Research B} 35: 627--641.

\bibitem{} Wilde, J. 2000. Identification of multiple equation probit models
with endogenous dummy regressors.\ \textit{Economics Letters} 69 (3):
309--312.

\bibitem{} Wilson, P. 2015. The misuse of the Vuong test for non-nested
models to test for zero-inflation. \textit{Economics Letters }127: 51--53.

\bibitem{} Winkelmann, R. 2008. \textit{Econometric analysis of count data}%
.\ 5$^{\text{th}}$ edition, Springer.
\end{thebibliography}

\section*{Appendix}

% Table generated by Excel2LaTeX from sheet 'params'

%TCIMACRO{%
%\TeXButton{A}{\setcounter{table}{0}
%\renewcommand{\thetable}{A\arabic{table}}}}%
%BeginExpansion
\setcounter{table}{0}
\renewcommand{\thetable}{A\arabic{table}}%
%EndExpansion
%TCIMACRO{%
%\TeXButton{B}{\begin{table}[H]\captionsetup{singlelinecheck = false, justification=justified}}}%
%BeginExpansion
\begin{table}[H]\captionsetup{singlelinecheck = false, justification=justified}%
%EndExpansion
\caption{Monte Carlo simulations: The true values of parameters\label{True
param}}%
%TCIMACRO{\TeXButton{TeX field}{\centering}}%
%BeginExpansion
\centering%
%EndExpansion

\begin{center}
%TCIMACRO{%
%\FRAME{itbpF}{6.4284in}{2.6766in}{0in}{}{}{Figure}{%
%\special{language "Scientific Word";type "GRAPHIC";maintain-aspect-ratio TRUE;display "USEDEF";valid_file "T";width 6.4284in;height 2.6766in;depth 0in;original-width 6.4001in;original-height 2.6484in;cropleft "0";croptop "1";cropright "1";cropbottom "0";tempfilename 'P8RJA003.wmf';tempfile-properties "XPR";}}}%
%BeginExpansion
\includegraphics[
natheight=2.6484in, natwidth=6.4001in, height=2.6766in, width=6.4284in]
{C:/Users/user/Documents/Dale/Our paper on Github/cnop/paper/graphics/P8RJA003__15.pdf}%
%EndExpansion
\end{center}

%TCIMACRO{\TeXButton{TeX field}{\justify}}%
%BeginExpansion
\justify%
%EndExpansion
%TCIMACRO{\TeXButton{TeX field}{\footnotesize}}%
%BeginExpansion
\footnotesize%
%EndExpansion

Notes: (exog) -- exogenous switching: $\rho =\rho ^{-}=\rho ^{+}=0$. The
variances $\sigma ^{2},$ $\sigma _{-}^{2},$ $\sigma _{+}^{2},$ and $\sigma
_{\nu }^{2}$ are all fixed to one in all models.

%TCIMACRO{\TeXButton{E}{\end{table}}}%
%BeginExpansion
\end{table}%
%EndExpansion

\bigskip

\end{document}
